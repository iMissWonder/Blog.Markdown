---
title: 基于Scrapy框架的爬虫学习心得（一）
date: 2017-04-05 11:09:54
tags: 爬虫
---
最近开始学习**爬虫**，在老师的指引下选择了**Scrapy**这个开源框架。由于对Linux系统并没有太熟练，并且对Python语言完全不了解，因此刚上手的时候和很多项目一样，感觉无从下手。不过我知道这类项目就是得一步一步来，从安装到学习需要花很多时间。
本系列的目的是总结爬虫框架**Scrapy的学习经历体会**，同时也记录一下自己走过的弯路。
第一篇是环境的配置搭建和Python语言的简要语法。
<!-- more -->

## Ubuntu环境配置
以下操作在Ubuntu16.10虚拟机上安装Scrapy以及集成开发环境Pycharm。

1. 安装虚拟机过程略
开始使用虚拟机时卡顿，是因为内存分配大小太小了（1G）。内存改为8G并迁移到固态硬盘后，运行极其流畅。

2. 安装scrapy需要pip,安装pip需要使用以下指令
`# sudo apt-get install python-pip`

3. 安装scrapy时跳了两个错，其中一个是目录没有权限，另一个是cryptography 包安装失败

4. 目录没有权限的问题可以使用
`# chown -R $USER /usr/local/bin/`
命令解决，我在这犯了一个严重的错误，错误地把/usr/权限全部分配给了当前用户，导致sudo命令出现sudo:must be setuid root

5. 解决方式
开机按ESC或者SHIFT进入RECOVERY MODE，进入ROOT SHELL
recovery模式默认是以只读模式挂载的，因此首先输入
`# mount -o remount,rw /`
然后修改权限
`# chown root:root /usr/bin/sudo`
`# chmod 4755 /usr/bin/sudo`
`# chown root /usr/lib/sudo/sudoers.so`
reboot后尝试ls命令检测sudo是否恢复
`# sudo ls`

6. cryptography安装失败的解决方式
首先尝试卸载cryptography
`# pip uninstall cryptography`
若失败使用上面的方式获取目录权限，然后再次卸载重新安装。
`# pip install cryptography`
这是我中间安装过的包，可能会是安装过程中缺少的包
`# pip install pymongo`
`# sudo apt-get install libssl-dev`

7. 最后执行scrapy安装
`# pip install scrapy`
如果有其他问题还是需要具体问题具体分析，毕竟依赖包太多了。

8. 安装Pycharm
Pycharm的安装十分简单，下载解压tar.gz后，按照说明文档执行该文件即可装完。

## 简要Python语法
这里只记录重点语法，一些细节不作深入分析。

### 交互式编程
交互式编程不需要创建脚本文件，是通过 Python 解释器的交互模式进来编写代码。
平时书写的C、C++、Java都是采用脚本式编程，而Python支持交互式编程，输入代码后即可显示结果，在初学Python时用于**测试**十分方便。
虽然在编写爬虫中，这种编程方式用不到……但是还是需要了解一下的！
*以下摘自CSDN的optman专栏*
> 习惯了C++的编程模式：编辑，保存，编译，运行和调试之后，就忘了其实还有另一种编程模式--交互式编程。很多脚本语言都提供类似的控制台，直接输入脚本语句，回车就执行了，结果立即显示出来，而不用经过复杂的保存和编译阶段。

### 脚本式编程
通过脚本参数调用解释器开始执行脚本，直到脚本执行完毕。当脚本执行完成后，解释器不再有效。
脚本文件后缀名为.py，这点和C与Java区分。在linux终端中可以用python example.py命令编译文件。

### Python 标识符
标识符大部分和C相同，要注意的是:下划线在Python标识符中有很重要的含义。
> 在python里，标识符有字母、数字、下划线组成。
> 在python中，所有标识符可以包括英文、数字以及下划线（_），但不能以数字开头。
> python中的标识符是区分大小写的。
> 以**下划线**开头的标识符是有特殊意义的。以**单下划线**开头（_foo）的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用"from xxx import *"而导入；
> 以**双下划线**开头的（__foo）代表类的私有成员；以**双下划线开头和结尾**的（__foo__）代表python里特殊方法专用的标识，如__init__（）代表类的构造函数。

### 行和缩进
行和缩进可谓是Python与其他语言最大的区别了！
> 学习Python与其他语言最大的区别就是，Python的代码块不使用大括号（{}）来控制类，函数以及其他逻辑判断。python最具特色的就是用**缩进**来写模块。
> **缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。**
> 在Python的代码块中必须使用相同数目的行首缩进空格数。
> 建议在每个缩进层次使用**单个制表符**或**两个空格**或**四个空格**, 切记不能混用。

### 多行语句
斜杠（ \）可以将一行的语句分为多行显示，但是语句中包含[], {} 或 () 括号就不需要使用多行连接符。
```Python
total = item_one + \
        item_two + \
        item_three
days = ['Monday', 'Tuesday', 'Wednesday',
                'Thursday', 'Friday']
```

### 三种引号
Python 可以使用引号( ' )、双引号( " )、三引号( ''' 或 """ ) 来表示字符串，引号的开始与结束必须的相同类型的。
其中三引号可以由多行组成，编写多行文本的快捷语法，常用语文档字符串，在文件的特定地点，被当做注释。
```Python
word = 'word'
sentence = "这是一个句子。"
paragraph = """这是一个段落。
包含了多个语句"""
```

### 注释
单行注释使用#开头。
多行注释使用三个单引号（'''）和三个多引号（"""）作为起始与结尾。

### 字典
最重要的概念。需要查资料仔细学。
